# executors.py — Интерфейсы выполнения кода (Порты)

**Путь:** `v1.5_PracticeRaptor/core/ports/executors.py`

Этот файл определяет **как система выполняет пользовательский код**. Он содержит интерфейсы для запуска кода и проверки его синтаксиса, абстрагируясь от конкретных реализаций (например, локальное выполнение, выполнение в контейнере).

---

## `ICodeExecutor` — Интерфейс исполнителя кода

```python
from typing import Protocol
from core.domain.models import TestCase, ExecutionResult
from core.domain.result import Result
from core.domain.errors import ExecutionError


class ICodeExecutor(Protocol):
    """Интерфейс для выполнения кода."""

    def execute(
        self,
        code: str,
        test_cases: tuple[TestCase, ...],
        function_name: str,
        timeout_sec: int = 5,
    ) -> Result[ExecutionResult, ExecutionError]:
        """
        Выполняет код пользователя против набора тестовых случаев.

        Аргументы:
            code: Пользовательский код для выполнения
            test_cases: Тестовые случаи для запуска
            function_name: Имя функции, которую нужно вызвать в коде
            timeout_sec: Максимальное время выполнения для каждого теста

        Возвращает:
            Result с ExecutionResult в случае успеха или ExecutionError в случае сбоя
        """
        ...

    def validate_syntax(self, code: str) -> Result[None, ExecutionError]:
        """
        Проверяет синтаксис кода.

        Аргументы:
            code: Код для валидации

        Возвращает:
            Ok(None), если синтаксис верен, Err(ExecutionError), если недействителен
        """
        ...
```

**Аналогия:** Представь, что это **учитель в классе программирования**. У него есть две основные задачи:
1. **`execute`**: Запустить программу ученика (код) и проверить её на разных заданиях (тестовые случаи). Если что-то пошло не так или время вышло — учитель сообщит об этом.
2. **`validate_syntax`**: Быстро просмотреть код и сказать, есть ли в нём очевидные ошибки (синтаксис), прежде чем запускать его.

**Зачем это нужно?**
- **Абстракция:** Позволяет системе работать с кодом, не зная, выполняется ли он локально, в удаленном сервисе или в изолированном контейнере.
- **Заменяемость:** Можно легко переключаться между разными исполнителями кода (например, для разных языков программирования или для более безопасного выполнения).
- **Тестирование:** Интерфейс упрощает создание моков для тестирования компонентов, которые зависят от выполнения кода.

---

## `ExecutionError` — Ошибка выполнения кода

Определение `ExecutionError` находится в `core/domain/errors.py`. Это ошибка, специфичная для проблем, возникающих в процессе выполнения пользовательского кода или при проверке его синтаксиса.
